// Code generated by icomplie. DO NOT EDIT !
package {{.Namespace}}_client

import (
	"context"
	"strconv"
{{- range .Imports}}
	{{.}}
{{- end}}
)

// {{.ServiceName}}Client is the client for {{.ServiceName}} service
type {{.ServiceName}}Client struct {
	client   HTTPClient
	basePath string
}

// New{{.ServiceName}}Client creates a new client instance
func New{{.ServiceName}}Client(client HTTPClient) *{{.ServiceName}}Client {
	return &{{.ServiceName}}Client{
		client:   client,
		basePath: "{{.BasePath}}",
	}
}

{{range .Methods}}
// {{.Name}} {{.Description}}
func (c *{{$.ServiceName}}Client) {{.Name}}(ctx context.Context{{.ParamsSignature}}) ({{.ReturnType}}, error) {
{{- if eq .HTTPMethod "POST"}}
	result := &{{.ResultType}}{}
	err := c.client.DoPost(ctx, "{{.FullPath}}", {{.BodyParam}}, nil, result)
	if err != nil {
		return nil, err
	}
	return result, nil
{{- else if eq .HTTPMethod "GET"}}
{{- if .HasParams}}
	params := make(map[string][]string)
{{- range .QueryParams}}
{{- if .IsList}}
	for _, v := range {{.ParamName}} {
		params["{{.ParamName}}"] = append(params["{{.ParamName}}"], {{.ConvertExpr}})
	}
{{- else}}
	params["{{.ParamName}}"] = []string{ {{.ConvertExpr}} }
{{- end}}
{{- end}}
	urlPath, err := c.client.BuildURL("{{.FullPath}}", params)
	if err != nil {
		return nil, err
	}
{{- else}}
	urlPath := "{{.FullPath}}"
{{- end}}
	result := &{{.ResultType}}{}
	err {{if .HasParams}}={{else}}:={{end}} c.client.DoGet(ctx, urlPath, nil, result)
	if err != nil {
		return nil, err
	}
	return result, nil
{{- else if eq .HTTPMethod "PUT"}}
	result := &{{.ResultType}}{}
	err := c.client.DoPost(ctx, "{{.FullPath}}", {{.BodyParam}}, nil, result)
	if err != nil {
		return nil, err
	}
	return result, nil
{{- end}}
}
{{end}}

// Ensure strconv is used (avoid unused import error)
var _ = strconv.Itoa
